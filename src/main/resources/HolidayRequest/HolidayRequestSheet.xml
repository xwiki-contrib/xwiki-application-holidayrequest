<?xml version="1.0" encoding="UTF-8"?>

<!--
 * See the NOTICE file distributed with this work for additional
 * information regarding copyright ownership.
 *
 * This is free software; you can redistribute it and/or modify it
 * under the terms of the GNU Lesser General Public License as
 * published by the Free Software Foundation; either version 2.1 of
 * the License, or (at your option) any later version.
 *
 * This software is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this software; if not, write to the Free
 * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA
 * 02110-1301 USA, or see the FSF site: http://www.fsf.org.
-->

<xwikidoc>
  <web>HolidayRequest</web>
  <name>HolidayRequestSheet</name>
  <language/>
  <defaultLanguage/>
  <translation>0</translation>
  <parent>HolidayRequest.HolidayRequestClass</parent>
  <creator>xwiki:XWiki.Admin</creator>
  <author>xwiki:XWiki.Admin</author>
  <customClass/>
  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>
  <creationDate>1401184624000</creationDate>
  <date>1401285679000</date>
  <contentUpdateDate>1401285679000</contentUpdateDate>
  <version>1.1</version>
  <title/>
  <defaultTemplate/>
  <validationScript/>
  <comment/>
  <minorEdit>false</minorEdit>
  <syntaxId>xwiki/2.1</syntaxId>
  <hidden>true</hidden>
  <object>
    <class>
      <name>XWiki.XWikiRights</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <allow>
        <defaultValue>1</defaultValue>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>allow</displayType>
        <name>allow</name>
        <number>4</number>
        <prettyName>Allow/Deny</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </allow>
      <groups>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>groups</name>
        <number>1</number>
        <picker>1</picker>
        <prettyName>Groups</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.GroupsClass</classType>
      </groups>
      <levels>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>1</multiSelect>
        <name>levels</name>
        <number>2</number>
        <prettyName>Levels</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>3</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.LevelsClass</classType>
      </levels>
      <users>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>users</name>
        <number>3</number>
        <picker>1</picker>
        <prettyName>Users</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.UsersClass</classType>
      </users>
    </class>
    <name>HolidayRequest.HolidayRequestSheet</name>
    <number>0</number>
    <className>XWiki.XWikiRights</className>
    <guid>75261aa3-2a2d-487e-9d57-b3c925c08586</guid>
    <property>
      <allow>1</allow>
    </property>
    <property>
      <groups>XWiki.HolidayRequestAdminGroup</groups>
    </property>
    <property>
      <levels>view,edit,comment,delete</levels>
    </property>
  </object>
  <object>
    <class>
      <name>XWiki.XWikiRights</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <allow>
        <defaultValue>1</defaultValue>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>allow</displayType>
        <name>allow</name>
        <number>4</number>
        <prettyName>Allow/Deny</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </allow>
      <groups>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>groups</name>
        <number>1</number>
        <picker>1</picker>
        <prettyName>Groups</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.GroupsClass</classType>
      </groups>
      <levels>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>1</multiSelect>
        <name>levels</name>
        <number>2</number>
        <prettyName>Levels</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>3</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.LevelsClass</classType>
      </levels>
      <users>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>users</name>
        <number>3</number>
        <picker>1</picker>
        <prettyName>Users</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.UsersClass</classType>
      </users>
    </class>
    <name>HolidayRequest.HolidayRequestSheet</name>
    <number>1</number>
    <className>XWiki.XWikiRights</className>
    <guid>80e5e521-40cb-4773-8dfe-c0030fb8fc5d</guid>
    <property>
      <allow>1</allow>
    </property>
    <property>
      <groups>XWiki.XWikiAllGroup</groups>
    </property>
    <property>
      <levels>view</levels>
    </property>
  </object>
  <object>
    <class>
      <name>XWiki.XWikiRights</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <allow>
        <defaultValue>1</defaultValue>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>allow</displayType>
        <name>allow</name>
        <number>4</number>
        <prettyName>Allow/Deny</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </allow>
      <groups>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>groups</name>
        <number>1</number>
        <picker>1</picker>
        <prettyName>Groups</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.GroupsClass</classType>
      </groups>
      <levels>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>1</multiSelect>
        <name>levels</name>
        <number>2</number>
        <prettyName>Levels</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>3</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.LevelsClass</classType>
      </levels>
      <users>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>users</name>
        <number>3</number>
        <picker>1</picker>
        <prettyName>Users</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.UsersClass</classType>
      </users>
    </class>
    <name>HolidayRequest.HolidayRequestSheet</name>
    <number>2</number>
    <className>XWiki.XWikiRights</className>
    <guid>ebeb80e9-d142-468c-a073-7a7ce99a1ede</guid>
    <property>
      <allow>1</allow>
    </property>
    <property>
      <groups>XWiki.XWikiAdminGroup</groups>
    </property>
    <property>
      <levels>view</levels>
    </property>
  </object>
  <object>
    <class>
      <name>XWiki.XWikiRights</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <allow>
        <defaultValue>1</defaultValue>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>allow</displayType>
        <name>allow</name>
        <number>4</number>
        <prettyName>Allow/Deny</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </allow>
      <groups>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>groups</name>
        <number>1</number>
        <picker>1</picker>
        <prettyName>Groups</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.GroupsClass</classType>
      </groups>
      <levels>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>1</multiSelect>
        <name>levels</name>
        <number>2</number>
        <prettyName>Levels</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>3</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.LevelsClass</classType>
      </levels>
      <users>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>users</name>
        <number>3</number>
        <picker>1</picker>
        <prettyName>Users</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.UsersClass</classType>
      </users>
    </class>
    <name>HolidayRequest.HolidayRequestSheet</name>
    <number>3</number>
    <className>XWiki.XWikiRights</className>
    <guid>0bb76d2d-9532-4942-b27e-ce7518feabff</guid>
    <property>
      <allow>1</allow>
    </property>
    <property>
      <levels>view</levels>
    </property>
    <property>
      <users>XWiki.XWikiGuest</users>
    </property>
  </object>
  <content>{{velocity}}
$xwiki.ssx.use("HolidayRequest.SkinExtension")
#set($employee = $!doc.getValue('employee'))
#set($manager = $!doc.getValue('manager'))
#set($user = $xwiki.getDocument($context.user))
#set($fullUser = "xwiki:$user")
#set($mail = $xwiki.getUserName($user, '$email', false))
#set($employeeMail = $xwiki.getUserName($employee, '$email', false))
#set($employeeShortName = $xwiki.getUserName($employee, '$first_name $last_name', false))
#set($employeeName = $xwiki.getUserName($employee, "$first_name $last_name", true))
#set($managerMail = $xwiki.getUserName($manager, '$email', false))
#set($isHRAdmin = $xwiki.getUser().isUserInGroup("XWiki.HolidayRequestAdminGroup") || $user==$manager || $fullUser==$manager)
#set($locale = $response.getLocale())
#set($hasRightModify = $isHRAdmin || ($user==$employee &amp;&amp; $doc.getValue('status')=='value3'))
#set($startDate = $datetool.format('full_date',$!doc.getValue("startDate"),$locale))
#set($endDate = $datetool.format('full_date',$!doc.getValue("endDate"),$locale))
#set($hr = $doc.getObject("HolidayRequest.HolidayRequestClass"))
#set($link = $doc.getExternalURL())
#set($token = $services.csrf.getToken())
#set($comment = $!request.comment.trim())
#set($confDoc = $!xwiki.getDocument('HolidayRequest.Configuration'))
#set($prefix = $!confDoc.getValue('prefix'))
#set($ccMail = $!confDoc.getValue('cc'))
#set($mailLanguage = $!confDoc.getValue('language'))
#set($startDateMail = $datetool.format('full_date',$!doc.getValue("startDate"),$mailLanguage))
#set($endDateMail = $datetool.format('full_date',$!doc.getValue("endDate"),$mailLanguage))

#if($ccMail.trim() == "")
  #set($ccMail = $xwiki.null)
#end

#if($request.newDoc=='true')
  #set($newDoc=true)
#else
  #set($newDoc=false)
#end
#if($request.createHR=='true')
  $doc.set('employee', $context.user)  ##It's the current user who is making a Holiday Request
  #set($managerProfile = $!xwiki.getUserName($context.user, "$manager", false)) ##From XWiki or from LDAP: sn=...,ou=users,dc=xwiki,dc=com
  #if($managerProfile.contains("="))
    $doc.set('manager', "xwiki:XWiki.${managerProfile.split(',')[0].split('=')[1]}")
  #elseif($managerProfile)
    $doc.set('manager', "$!managerProfile")  
  #end
  $doc.set('notification', 0)
  #set($office = $!xwiki.getUserName($context.user, '$office', false))
  #if($office!='$office')
    $doc.set('office', $office)
  #else
    $doc.set('office', '-')
  #end
  $doc.set('status', 'value3')  ##The status is "Pending"
  $doc.save()
  $response.sendRedirect($doc.getURL('view', 'newDoc=true'))
#elseif(!$newDoc &amp;&amp; $doc.getValue('notification') == 0 &amp;&amp; $doc.name!="HolidayRequestTemplate") 
  #if($doc.getValue('manager')=="")  ##Si pas de manager défini
    {{warning}}$msg.get('contrib.hr.notify.error.noManager'){{/warning}}
    #set($newDoc=true)
  #else
    #if(!$!doc.getValue('startDate') || !$!doc.getValue('endDate'))
      {{warning}}$msg.get('contrib.hr.notify.error.nullDate'){{/warning}}
      #set($newDoc=true)
    #elseif($doc.getValue('startDate').compareTo($doc.getValue('endDate'))==1)  ##If endDate is before startDate
      {{warning}}$msg.get('contrib.hr.notify.error.orderDate'){{/warning}}
      #set($newDoc=true)
    #else
      $doc.set('notification', 1)
      $doc.save()
      #if($employeeShortName != "")
        #set($title = $msg.get("contrib.hr.email.notify.title.$mailLanguage", [$employeeShortName,$startDateMail,$endDateMail]))
      #else
        #set($title = $msg.get("contrib.hr.email.notify.title.$mailLanguage", [$employee,$startDateMail,$endDateMail]))
      #end
      #set($title = "$prefix $title")
      #set($message = $msg.get("contrib.hr.email.notify.text.$mailLanguage", [$employeeShortName,$startDateMail,$endDateMail]))
      #if($xwiki.mailsender.sendHtmlMessage($employeeMail, $managerMail, $ccMail, $xwiki.null, $title, "$message &lt;br&gt;&lt;br&gt;&lt;a href=$link&gt;$link&lt;/a&gt;", "$message${util.getNewline()}$link", "")==0)  ##Send a copy to employee?
        $msg.get('contrib.hr.email.notify.success')
      #else
        {{warning}}$msg.get('contrib.hr.email.notify.failure'){{/warning}}
      #end
    #end
  #end
#end
#if($request.delete)
  $doc.delete()
  $response.sendRedirect($xwiki.getURL('HolidayRequest.WebHome'))
#end
#if ($request.accept &amp;&amp; $isHRAdmin)
  $doc.set('comment', $!comment)
  $doc.set('status', 'value1')
  $doc.save()
  #set($title = $msg.get("contrib.hr.email.accept.title.$mailLanguage", [$startDateMail,$endDateMail]))
  #set($title = "$prefix $title")
  #set($message = $msg.get("contrib.hr.email.accept.text.$mailLanguage", [$startDateMail,$endDateMail]))
  #if($xwiki.mailsender.sendHtmlMessage($managerMail, $employeeMail, $ccMail, $xwiki.null, $title, "$message &lt;br&gt;&lt;br&gt;&lt;a href=$link&gt;$link&lt;/a&gt;", "$message${util.getNewline()}$link", "")==0)
    $msg.get('contrib.hr.email.accept.success')
  #else
    {{warning}}$msg.get('contrib.hr.email.accept.failure'){{/warning}}
  #end
#end
#if ($request.refuse &amp;&amp; $isHRAdmin)
  #if($comment != "")
    $doc.set('comment', $!comment)
	$doc.set('status', 'value4')
    $doc.save()
    #set($title = $msg.get("contrib.hr.email.refuse.title.$mailLanguage", [$startDateMail,$endDateMail]))
    #set($title = "$prefix $title")
    #set($message = $msg.get("contrib.hr.email.refuse.text.$mailLanguage", [$startDateMail,$endDateMail]))
    #if($xwiki.mailsender.sendHtmlMessage($managerMail, $employeeMail, $ccMail, $xwiki.null, $title, "$message &lt;br&gt;&lt;em&gt;$comment&lt;/em&gt; &lt;br&gt;&lt;br&gt;&lt;a href=$link&gt;$link&lt;/a&gt;", "$message${util.getNewline()}$comment${util.getNewline()}$link", "")==0)
      $msg.get('contrib.hr.email.refuse.success')
	#else
      {{warning}}$msg.get('contrib.hr.email.refuse.failure'){{/warning}}
    #end
  #else
    {{warning}}$msg.get('contrib.hr.notify.error.refuse.noComment'){{/warning}}
  #end
#end
#if ($request.cancel == 'true' &amp;&amp; $user==$employee)
  $doc.set('status', 'value2')
  $doc.save()
  #if($employeeShortName != "")
    #set($title = $msg.get("contrib.hr.email.cancel.title.$mailLanguage", [$employeeShortName,$startDateMail,$endDateMail]))
  #else
    #set($title = $msg.get("contrib.hr.email.cancel.title.$mailLanguage", [$employee,$startDateMail,$endDateMail]))
  #end
  #set($title = "$prefix $title")
  #set($message = $msg.get("contrib.hr.email.cancel.text.$mailLanguage", [$employeeShortName,$startDateMail,$endDateMail]))
  #if($xwiki.mailsender.sendHtmlMessage($employeeMail, $managerMail, $ccMail, $xwiki.null, $title, "$message &lt;br&gt;&lt;br&gt;&lt;a href=$link&gt;$link&lt;/a&gt;", "$message${util.getNewline()}$link", "")==0)  ##Send a copy to employee?
    $msg.get('contrib.hr.email.cancel.success')
  #else
    {{warning}}$msg.get('contrib.hr.email.cancel.failure'){{/warning}}
  #end
#end



{{html wiki="true"}}
$xwiki.ssx.use('AppWithinMinutes.ClassSheetGenerator')
#set($discard = $doc.use('HolidayRequest.HolidayRequestClass'))
## We don't have access to the form element to set the CSS class for the vertical form layout standard.

#if($hr)
$doc.setTitle($msg.get('contrib.hr.requestPage.title'))
#if($context.action == "view" &amp;&amp; !$newDoc)
  #if($xwiki.getUserName($employee, '$first_name$last_name', false)!="")
    #set($employeeDisplay = $employeeName)
  #else
    #set($employeeDisplay = $doc.display('employee'))
  #end
  $msg.get('contrib.hr.request', [$employeeDisplay, $startDate, $endDate])  
    &lt;div style="position:relative;"&gt;

    (% class="tableHR" %)
    |=&lt;label for="HolidayRequest.HolidayRequestClass_0_numberDays"&gt;$msg.get('contrib.hr.numberDays')&lt;/label&gt; |$doc.display('numberDays')
    |=&lt;label for="HolidayRequest.HolidayRequestClass_0_type"&gt;$msg.get('contrib.hr.type')&lt;/label&gt;             |$doc.display('type')
    |=&lt;label for="HolidayRequest.HolidayRequestClass_0_office"&gt;$msg.get('contrib.hr.office')&lt;/label&gt;         |$doc.display('office')
    |=&lt;label for="HolidayRequest.HolidayRequestClass_0_manager"&gt;$msg.get('contrib.hr.manager')&lt;/label&gt;       |$doc.display('manager')
    |=&lt;label for="HolidayRequest.HolidayRequestClass_0_status"&gt;$msg.get('contrib.hr.status')&lt;/label&gt;         |$doc.display("status")
    
    &lt;div class="rightCol"&gt;
    #set($actualStatus = $doc.getValue('status'))
	#if($actualStatus != 'value3' &amp;&amp; $!doc.getValue('employee') != "" &amp;&amp; $doc.display("comment").trim() != "")
      **&lt;label for="HolidayRequest.HolidayRequestClass_0_comment"&gt;$msg.get('contrib.hr.comment') :&lt;/label&gt;** &lt;br /&gt;
      $doc.display("comment")
    #end
    #if($isHRAdmin &amp;&amp; $actualStatus == 'value3')  ##If admin rights and status=Pending
      &lt;form action=""  method="post" id="statusAccepted" class='xform'&gt;
      **&lt;label for="HolidayRequest.HolidayRequestClass_0_comment"&gt;$msg.get('contrib.hr.comment') :&lt;/label&gt;** &lt;br /&gt;
          &lt;textarea cols="60" id="HolidayRequest.HolidayRequestClass_0_comment" name="comment" rows="7"&gt;&lt;/textarea&gt;&lt;br /&gt;
          &lt;div align="center"&gt;
            &lt;span class="buttonwrapper"&gt;
              &lt;input class="button" type="submit" name="accept" value="$msg.get('contrib.hr.accept.submit')" /&gt;
            &lt;/span&gt;
            &lt;span class="buttonwrapper"&gt;
              &lt;input class="button" type="submit" name="refuse" value="$msg.get('contrib.hr.refuse.submit')" /&gt;
            &lt;/span&gt;
          &lt;/div&gt;
      &lt;/form&gt;
    #end
    #if($user == $employee &amp;&amp; $actualStatus == 'value3')
      &lt;form action="" id="statusCancelled"&gt;
        &lt;div align="center"&gt;
          &lt;span class="buttonwrapper"&gt;
            &lt;input type="hidden" name="cancel" value="true" /&gt;
            &lt;input class="button" type="submit" value="$msg.get('contrib.hr.cancel.submit')" /&gt;
          &lt;/span&gt;
        &lt;/div&gt;
      &lt;/form&gt;
    #end
    &lt;/div&gt;
    &lt;/div&gt;
#elseif($context.action=="view" &amp;&amp; $newDoc)
    &lt;form action="" method="post" id="sendNotification" class='xform'&gt;
      &lt;div&gt;
        &lt;input type="hidden" name="form_token" value=$token&gt;
		
		(% class="tableHR" %)
        |=&lt;label for="HolidayRequest.HolidayRequestClass_0_employee"&gt;$msg.get('contrib.hr.employee')&lt;/label&gt;      |$!doc.display('employee')
        |=&lt;label for="HolidayRequest.HolidayRequestClass_0_startDate"&gt;$msg.get('contrib.hr.startDate')&lt;/label&gt;    |$doc.display('startDate', 'edit')
        |=&lt;label for="HolidayRequest.HolidayRequestClass_0_endDate"&gt;$msg.get('contrib.hr.endDate')&lt;/label&gt;        |$doc.display('endDate', 'edit')
        |=&lt;label for="HolidayRequest.HolidayRequestClass_0_numberDays"&gt;$msg.get('contrib.hr.numberDays')&lt;/label&gt;  |$doc.display('numberDays', 'edit')
	    |=&lt;label for="HolidayRequest.HolidayRequestClass_0_type"&gt;$msg.get('contrib.hr.type')&lt;/label&gt;              |$doc.display('type', 'edit')
        |=&lt;label for="HolidayRequest.HolidayRequestClass_0_manager"&gt;$msg.get('contrib.hr.manager')&lt;/label&gt;        |&lt;div style="width:84%"&gt;$doc.display('manager', 'edit')&lt;/div&gt;
        |=&lt;label for="HolidayRequest.HolidayRequestClass_0_status"&gt;$msg.get('contrib.hr.status')&lt;/label&gt;          |$doc.display('status')
		
        &lt;div class="rightCol" align="center"&gt;
		  &lt;br /&gt;&lt;br /&gt;
          &lt;span class="buttonwrapper"&gt;
            &lt;input class="button" type="submit" value="$msg.get('contrib.hr.notify.submit')" name="action_save"&gt;
          &lt;/span&gt;
		  &lt;br /&gt;&lt;br /&gt;
          &lt;span class="buttonwrapper"&gt;
            &lt;input class="button" type="submit" value="$msg.get('contrib.hr.notify.cancel')" name="delete"&gt;
          &lt;/span&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/form&gt;
#elseif($context.action == "export")
   #if($xwiki.getUserName($employee, '$first_name$last_name', false)!="")
    #set($employeeDisplay = $employeeShortName)
  #else
    #set($employeeDisplay = $doc.display('employee'))
  #end
  $msg.get('contrib.hr.pdf.request', [$employeeDisplay, $startDate, $endDate])
#else   ##Edit mode
  #if(!$hasRightModify &amp;&amp; !$newDoc)
    $msg.get('contrib.hr.error.noModif') 
  #else
  (% class="xform" %)
  (((
    ; &lt;label for="HolidayRequest.HolidayRequestClass_0_employee"&gt;$msg.get('contrib.hr.employee')&lt;/label&gt;##
      (% class="xHint" %)$msg.get('')
    : $!doc.display('employee','view')
    ; &lt;label for="HolidayRequest.HolidayRequestClass_0_startDate"&gt;$msg.get('contrib.hr.startDate')&lt;/label&gt;##
      (% class="xHint" %)$msg.get('')
    : $doc.display('startDate')
    ; &lt;label for="HolidayRequest.HolidayRequestClass_0_endDate"&gt;$msg.get('contrib.hr.endDate')&lt;/label&gt;##
      (% class="xHint" %)$msg.get('')
    : $doc.display('endDate')
    ; &lt;label for="HolidayRequest.HolidayRequestClass_0_numberDays"&gt;$msg.get('contrib.hr.numberDays')&lt;/label&gt;##
      (% class="xHint" %)$msg.get('')
    : $doc.display('numberDays')
    ; &lt;label for="HolidayRequest.HolidayRequestClass_0_type"&gt;$msg.get('contrib.hr.type')&lt;/label&gt;##
      (% class="xHint" %)$msg.get('')
    : $doc.display('type')
    ; &lt;label for="HolidayRequest.HolidayRequestClass_0_manager"&gt;$msg.get('contrib.hr.manager')&lt;/label&gt;##
      (% class="xHint" %)$msg.get('')
    : $doc.display('manager')
    ; &lt;label for="HolidayRequest.HolidayRequestClass_0_status"&gt;$msg.get('contrib.hr.status')&lt;/label&gt;##
      (% class="xHint" %)$msg.get('')
    #if($isHRAdmin)
      : $doc.display('status')
    #else
      : $doc.display('status', 'view')
    #end
  )))
  #end
#end

#else
  $msg.get('contrib.hr.sheet.message')
#end

{{/html}}

{{/velocity}}</content>
</xwikidoc>
